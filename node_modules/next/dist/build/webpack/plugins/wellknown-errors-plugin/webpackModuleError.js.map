{"version":3,"sources":["../../../../../build/webpack/plugins/wellknown-errors-plugin/webpackModuleError.ts"],"names":["getFilename","compilation","m","ctx","compiler","context","resource","res","path","relative","replace","posix","sep","startsWith","requestShortener","readableIdentifier","request","userRequest","getModuleBuildError","input","name","Boolean","module","error","Error","err","sourceFilename","babel","css"],"mappings":"qFAAA,kDAGA,wCACA,oC,qzBAGA,QAASA,CAAAA,WAAT,CAAqBC,WAArB,CAA2DC,CAA3D,CAA2E,wEACzE,GAAIC,CAAAA,GAAkB,sDACpBF,WAAW,CAACG,QADQ,iDACpB,uBAAsBC,OADF,+DACaJ,WAAW,CAACI,OADzB,6BACoC,IAD1D,CAEA,GAAIF,GAAG,GAAK,IAAR,EAAgB,MAAOD,CAAAA,CAAC,CAACI,QAAT,GAAsB,QAA1C,CAAoD,CAClD,KAAMC,CAAAA,GAAG,CAAGC,IAAI,CAACC,QAAL,CAAcN,GAAd,CAAmBD,CAAC,CAACI,QAArB,EAA+BI,OAA/B,CAAuC,KAAvC,CAA8CF,IAAI,CAACG,KAAL,CAAWC,GAAzD,CAAZ,CACA,MAAOL,CAAAA,GAAG,CAACM,UAAJ,CAAe,GAAf,EAAsBN,GAAtB,CAA6B,IAAGC,IAAI,CAACG,KAAL,CAAWC,GAAI,GAAEL,GAAI,EAA5D,CACD,CAED,KAAMO,CAAAA,gBAAgB,CAAGb,WAAW,CAACa,gBAArC,CACA,GAAI,OAAOZ,CAAP,SAAOA,CAAP,iBAAOA,CAAC,CAAEa,kBAAV,IAAiC,UAArC,CAAiD,CAC/C,MAAOb,CAAAA,CAAC,CAACa,kBAAF,CAAqBD,gBAArB,CAAP,CACD,CAED,yBAAOZ,CAAC,CAACc,OAAT,yCAAoBd,CAAC,CAACe,WAAtB,+BAAqC,WAArC,CACD,CAEM,QAASC,CAAAA,mBAAT,CACLjB,WADK,CAELkB,KAFK,CAGuB,CAC5B,GACE,EACE,MAAOA,CAAAA,KAAP,GAAiB,QAAjB,EACA,CAAAA,KAAK,OAAL,EAAAA,KAAK,SAAL,QAAAA,KAAK,CAAEC,IAAP,IAAgB,kBADhB,EAEAC,OAAO,CAACF,KAAK,CAACG,MAAP,CAFP,EAGAH,KAAK,CAACI,KAAN,WAAuBC,CAAAA,KAJzB,CADF,CAOE,CACA,MAAO,MAAP,CACD,CAED,KAAMC,CAAAA,GAAU,CAAGN,KAAK,CAACI,KAAzB,CACA,KAAMG,CAAAA,cAAc,CAAG1B,WAAW,CAACC,WAAD,CAAckB,KAAK,CAACG,MAApB,CAAlC,CAEA,KAAMK,CAAAA,KAAK,CAAG,8BAAcD,cAAd,CAA8BD,GAA9B,CAAd,CACA,GAAIE,KAAK,GAAK,KAAd,CAAqB,CACnB,MAAOA,CAAAA,KAAP,CACD,CAED,KAAMC,CAAAA,GAAG,CAAG,0BAAYF,cAAZ,CAA4BD,GAA5B,CAAZ,CACA,GAAIG,GAAG,GAAK,KAAZ,CAAmB,CACjB,MAAOA,CAAAA,GAAP,CACD,CAED,MAAO,MAAP,CACD","sourcesContent":["import * as path from 'path'\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { compilation } from 'webpack'\nimport { getBabelError } from './parseBabel'\nimport { getCssError } from './parseCss'\nimport { SimpleWebpackError } from './simpleWebpackError'\n\nfunction getFilename(compilation: compilation.Compilation, m: any): string {\n  let ctx: string | null =\n    compilation.compiler?.context ?? compilation.context ?? null\n  if (ctx !== null && typeof m.resource === 'string') {\n    const res = path.relative(ctx, m.resource).replace(/\\\\/g, path.posix.sep)\n    return res.startsWith('.') ? res : `.${path.posix.sep}${res}`\n  }\n\n  const requestShortener = compilation.requestShortener\n  if (typeof m?.readableIdentifier === 'function') {\n    return m.readableIdentifier(requestShortener)\n  }\n\n  return m.request ?? m.userRequest ?? '<unknown>'\n}\n\nexport function getModuleBuildError(\n  compilation: compilation.Compilation,\n  input: any\n): SimpleWebpackError | false {\n  if (\n    !(\n      typeof input === 'object' &&\n      input?.name === 'ModuleBuildError' &&\n      Boolean(input.module) &&\n      input.error instanceof Error\n    )\n  ) {\n    return false\n  }\n\n  const err: Error = input.error\n  const sourceFilename = getFilename(compilation, input.module)\n\n  const babel = getBabelError(sourceFilename, err)\n  if (babel !== false) {\n    return babel\n  }\n\n  const css = getCssError(sourceFilename, err)\n  if (css !== false) {\n    return css\n  }\n\n  return false\n}\n"]}