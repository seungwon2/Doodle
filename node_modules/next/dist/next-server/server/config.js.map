{"version":3,"sources":["../../../next-server/server/config.ts"],"names":["targets","reactModes","defaultConfig","env","webpack","webpackDevMiddleware","distDir","assetPrefix","configOrigin","useFileSystemPublicRoutes","generateBuildId","generateEtags","pageExtensions","target","poweredByHeader","compress","devIndicators","buildActivity","autoPrerender","onDemandEntries","maxInactiveAge","pagesBufferLength","amp","canonicalBase","exportTrailingSlash","sassOptions","experimental","cpus","Math","max","Number","process","CIRCLE_NODE_TOTAL","os","length","granularChunks","modern","plugins","profiling","sprFlushToDisk","reactMode","workerThreads","basePath","pageEnv","productionBrowserSourceMaps","optionalCatchAll","future","excludeDefaultMomentLocales","serverRuntimeConfig","publicRuntimeConfig","reactStrictMode","experimentalWarning","Log","warn","chalk","bold","console","assignDefaults","userConfig","Object","keys","forEach","key","userDistDir","trim","Error","undefined","Array","isArray","ext","maybeObject","constructor","result","startsWith","endsWith","normalizeConfig","phase","config","then","loadConfig","dir","customConfig","path","findUp","sync","CONFIG_FILE","cwd","userConfigModule","require","default","yellow","includes","join","slice","configBaseName","nonJsPath","isTargetLikeServerless","isServerless","isServerlessTrace"],"mappings":"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","sourcesContent":["import chalk from 'next/dist/compiled/chalk'\nimport findUp from 'next/dist/compiled/find-up'\nimport os from 'os'\nimport { basename, extname } from 'path'\n\nimport { CONFIG_FILE } from '../lib/constants'\nimport { execOnce } from '../lib/utils'\nimport * as Log from '../../build/output/log'\n\nconst targets = ['server', 'serverless', 'experimental-serverless-trace']\nconst reactModes = ['legacy', 'blocking', 'concurrent']\n\nconst defaultConfig: { [key: string]: any } = {\n  env: [],\n  webpack: null,\n  webpackDevMiddleware: null,\n  distDir: '.next',\n  assetPrefix: '',\n  configOrigin: 'default',\n  useFileSystemPublicRoutes: true,\n  generateBuildId: () => null,\n  generateEtags: true,\n  pageExtensions: ['tsx', 'ts', 'jsx', 'js'],\n  target: 'server',\n  poweredByHeader: true,\n  compress: true,\n  devIndicators: {\n    buildActivity: true,\n    autoPrerender: true,\n  },\n  onDemandEntries: {\n    maxInactiveAge: 60 * 1000,\n    pagesBufferLength: 2,\n  },\n  amp: {\n    canonicalBase: '',\n  },\n  exportTrailingSlash: false,\n  sassOptions: {},\n  experimental: {\n    cpus: Math.max(\n      1,\n      (Number(process.env.CIRCLE_NODE_TOTAL) ||\n        (os.cpus() || { length: 1 }).length) - 1\n    ),\n    granularChunks: true,\n    modern: false,\n    plugins: false,\n    profiling: false,\n    sprFlushToDisk: true,\n    reactMode: 'legacy',\n    workerThreads: false,\n    basePath: '',\n    pageEnv: false,\n    productionBrowserSourceMaps: false,\n    optionalCatchAll: false,\n  },\n  future: {\n    excludeDefaultMomentLocales: false,\n  },\n  serverRuntimeConfig: {},\n  publicRuntimeConfig: {},\n  reactStrictMode: false,\n}\n\nconst experimentalWarning = execOnce(() => {\n  Log.warn(chalk.bold('You have enabled experimental feature(s).'))\n  Log.warn(\n    `Experimental features are not covered by semver, and may cause unexpected or broken application behavior. ` +\n      `Use them at your own risk.`\n  )\n  console.warn()\n})\n\nfunction assignDefaults(userConfig: { [key: string]: any }) {\n  Object.keys(userConfig).forEach((key: string) => {\n    if (\n      key === 'experimental' &&\n      userConfig[key] &&\n      userConfig[key] !== defaultConfig[key]\n    ) {\n      experimentalWarning()\n    }\n\n    if (key === 'distDir') {\n      if (typeof userConfig[key] !== 'string') {\n        userConfig[key] = defaultConfig.distDir\n      }\n      const userDistDir = userConfig[key].trim()\n\n      // don't allow public as the distDir as this is a reserved folder for\n      // public files\n      if (userDistDir === 'public') {\n        throw new Error(\n          `The 'public' directory is reserved in Next.js and can not be set as the 'distDir'. https://err.sh/zeit/next.js/can-not-output-to-public`\n        )\n      }\n      // make sure distDir isn't an empty string as it can result in the provided\n      // directory being deleted in development mode\n      if (userDistDir.length === 0) {\n        throw new Error(\n          `Invalid distDir provided, distDir can not be an empty string. Please remove this config or set it to undefined`\n        )\n      }\n    }\n\n    if (key === 'pageExtensions') {\n      const pageExtensions = userConfig[key]\n\n      if (pageExtensions === undefined) {\n        delete userConfig[key]\n        return\n      }\n\n      if (!Array.isArray(pageExtensions)) {\n        throw new Error(\n          `Specified pageExtensions is not an array of strings, found \"${pageExtensions}\". Please update this config or remove it.`\n        )\n      }\n\n      if (!pageExtensions.length) {\n        throw new Error(\n          `Specified pageExtensions is an empty array. Please update it with the relevant extensions or remove it.`\n        )\n      }\n\n      pageExtensions.forEach((ext) => {\n        if (typeof ext !== 'string') {\n          throw new Error(\n            `Specified pageExtensions is not an array of strings, found \"${ext}\" of type \"${typeof ext}\". Please update this config or remove it.`\n          )\n        }\n      })\n    }\n\n    const maybeObject = userConfig[key]\n    if (!!maybeObject && maybeObject.constructor === Object) {\n      userConfig[key] = {\n        ...(defaultConfig[key] || {}),\n        ...userConfig[key],\n      }\n    }\n  })\n\n  const result = { ...defaultConfig, ...userConfig }\n\n  if (typeof result.assetPrefix !== 'string') {\n    throw new Error(\n      `Specified assetPrefix is not a string, found type \"${typeof result.assetPrefix}\" https://err.sh/zeit/next.js/invalid-assetprefix`\n    )\n  }\n  if (result.experimental) {\n    if (typeof result.experimental.basePath !== 'string') {\n      throw new Error(\n        `Specified basePath is not a string, found type \"${typeof result\n          .experimental.basePath}\"`\n      )\n    }\n\n    if (result.experimental.basePath !== '') {\n      if (result.experimental.basePath === '/') {\n        throw new Error(\n          `Specified basePath /. basePath has to be either an empty string or a path prefix\"`\n        )\n      }\n\n      if (!result.experimental.basePath.startsWith('/')) {\n        throw new Error(\n          `Specified basePath has to start with a /, found \"${result.experimental.basePath}\"`\n        )\n      }\n\n      if (result.experimental.basePath !== '/') {\n        if (result.experimental.basePath.endsWith('/')) {\n          throw new Error(\n            `Specified basePath should not end with /, found \"${result.experimental.basePath}\"`\n          )\n        }\n\n        if (result.assetPrefix === '') {\n          result.assetPrefix = result.experimental.basePath\n        }\n      }\n    }\n  }\n  return result\n}\n\nexport function normalizeConfig(phase: string, config: any) {\n  if (typeof config === 'function') {\n    config = config(phase, { defaultConfig })\n\n    if (typeof config.then === 'function') {\n      throw new Error(\n        '> Promise returned in next config. https://err.sh/zeit/next.js/promise-in-next-config'\n      )\n    }\n  }\n  return config\n}\n\nexport default function loadConfig(\n  phase: string,\n  dir: string,\n  customConfig?: object | null\n) {\n  if (customConfig) {\n    return assignDefaults({ configOrigin: 'server', ...customConfig })\n  }\n  const path = findUp.sync(CONFIG_FILE, {\n    cwd: dir,\n  })\n\n  // If config file was found\n  if (path?.length) {\n    const userConfigModule = require(path)\n    const userConfig = normalizeConfig(\n      phase,\n      userConfigModule.default || userConfigModule\n    )\n\n    if (Object.keys(userConfig).length === 0) {\n      console.warn(\n        chalk.yellow.bold('Warning: ') +\n          'Detected next.config.js, no exported configuration found. https://err.sh/zeit/next.js/empty-configuration'\n      )\n    }\n\n    if (userConfig.target && !targets.includes(userConfig.target)) {\n      throw new Error(\n        `Specified target is invalid. Provided: \"${\n          userConfig.target\n        }\" should be one of ${targets.join(', ')}`\n      )\n    }\n\n    if (userConfig.amp?.canonicalBase) {\n      const { canonicalBase } = userConfig.amp || ({} as any)\n      userConfig.amp = userConfig.amp || {}\n      userConfig.amp.canonicalBase =\n        (canonicalBase.endsWith('/')\n          ? canonicalBase.slice(0, -1)\n          : canonicalBase) || ''\n    }\n\n    if (\n      userConfig.experimental?.reactMode &&\n      !reactModes.includes(userConfig.experimental.reactMode)\n    ) {\n      throw new Error(\n        `Specified React Mode is invalid. Provided: ${\n          userConfig.experimental.reactMode\n        } should be one of ${reactModes.join(', ')}`\n      )\n    }\n\n    return assignDefaults({ configOrigin: CONFIG_FILE, ...userConfig })\n  } else {\n    const configBaseName = basename(CONFIG_FILE, extname(CONFIG_FILE))\n    const nonJsPath = findUp.sync(\n      [\n        `${configBaseName}.jsx`,\n        `${configBaseName}.ts`,\n        `${configBaseName}.tsx`,\n        `${configBaseName}.json`,\n      ],\n      { cwd: dir }\n    )\n    if (nonJsPath?.length) {\n      throw new Error(\n        `Configuring Next.js via '${basename(\n          nonJsPath\n        )}' is not supported. Please replace the file with 'next.config.js'.`\n      )\n    }\n  }\n\n  return defaultConfig\n}\n\nexport function isTargetLikeServerless(target: string) {\n  const isServerless = target === 'serverless'\n  const isServerlessTrace = target === 'experimental-serverless-trace'\n  return isServerless || isServerlessTrace\n}\n"]}